<H2>DESCRIPTION</H2>

<EM>d.out.gpsdrive</EM> exports the current GRASS display monitor to a 
<A HREF="http://gpsdrive.kraftvoll.at">GpsDrive</a> compatible backdrop 
image and updates the GpsDrive image list with the appropriate geo-referencing
information.

<P>
<b><em>Use at your own risk. Do not use as a primary means of navigation.
This software comes with absolutely no warranty.</em></b>


<P>
<H2>NOTES</H2>

Maps are saved in the user's <tt>~/.gpsdrive</tt> directory. Geo-referencing
information is added to the user's <tt>~/.gpsdrive/map_koord.txt</tt> file.
<P>

GpsDrive assumes northings are not rotated compared to true-geographic north.
If you are using a projection with significant curvature away from the central
meridian, or a map datum with a significant rotational component, then you will 
likely end up with a distorted or inexact background map!
Keeping the area small will lessen the error, but not eliminate it.
<P>
Best output is created from a Lat/Lon location or by keeping the output area
small (1:50,000). This translates to approx a 22.7km x 18.2km image window in the 
GIS. [<tt>x_ext=scale*(1280/2817.95)</tt>]
<P>
For your convenience (calculations are rough, but nominal):
<div class="code"><pre>
1:50,000 uses a region 22.7km x 18.2km.
1:75,000 uses a region 34.1km x 27.3km.
1:100,000 uses a region  45.4km x 36.3km.
1:175,000 uses a region  79.5km x 63.6km.
</pre></div>
<BR>


Maps exported from lat-lon locations will be given a "<tt>top_</tt>" prefix.
Maps exported from locations of other projections will be given a 
"<tt>map_</tt>" prefix. This is done so GpsDrive knows how to scale the 
image correctly.
<P>
GpsDrive requires backdrop images to be 1280x1024 pixels in size. While this
script takes care of that automatically, to avoid annoying bands on the sides
of your image you may want to set up your display monitor at half-scale (same
aspect ratio) and use d.zoom to select the full frame. For example:
<P>
<div class="code"><pre>
export GRASS_WIDTH=640
export GRASS_HEIGHT=512
d.mon x0
</pre></div>

<BR>
Map scaling is set from the region settings so should work correctly even 
when the display's aspect ratio does not match that of the output image.


<h3>Batch export</h3>

It may be desirable to create a series of image tiles covering a large area.
An easy way to do this is to run <em>d.out.gpsdrive</em> in a shell loop.
Here is an example Bash script contributed by Manuel Morales:
<P>
<div class="code"><pre>
#!/bin/bash

# map scale is determined by "panels" by dividing the N-S
# region extent into that number of maps. Note that the
# generated maps overlap by 1/2 along the N-S axis and by
# approximately 1/2 along the E-W axis.
panels=3
iter=$((panels*2-1))

eval `g.region -eg`

unit_ns=$(echo "scale=8; $ns_extent / $panels" | bc)
unit_ew=$(echo "scale=8; $unit_ns * 4/3" | bc)

panels_ew=$(echo "((2*$ew_extent / $unit_ew +.5 ) -1) / 1" | bc)

for i in `seq 1 $panels_ew`;
do
  east=$(echo "scale=8; $west+$unit_ew" | bc)
  for j in `seq 1 $iter`;
    do
    g.region n=$(echo "scale=8; $north-($j-1) * $unit_ns/2" | bc)      \
        s=$(echo "scale=8; $north-($j-1) * $unit_ns/2-$unit_ns" | bc ) \
        w=$west e=$east ewres=$ewres nsres=$nsres
        d.redraw
        d.out.gpsdrive -j tile_${i}_${j}
    done
  shift_west=$(echo "scale=8; ($ew_extent-$unit_ew)/($panels_ew-1)" | bc)
  west=$(echo "scale=8; $west+$shift_west" | bc)
done
</pre></div>

<BR>
Note that to get a smoother transition between backdrop maps this script
creates overlapping tiles.


<BR><BR>
<H2>SEE ALSO</H2>

<EM><A HREF="d.info.html">d.info</A></EM>,
<EM><A HREF="d.grid.html">d.grid</A></EM>,
<EM><A HREF="d.out.file.html">d.out.file</A></EM>,
<EM><A HREF="d.out.png.html">d.out.png</A></EM>,
<EM><A HREF="d.save.html">d.save</A></EM>,
<EM><A HREF="g.region.html">g.region</A></EM>,
<EM><A HREF="v.in.garmin.html">v.in.garmin</A></EM>
<BR><BR>
The GRASS <A HREF="pngdriver.html">PNG driver</A><BR>

The <A HREF="http://gpsdrive.kraftvoll.at">GpsDrive</a> project<BR>
The <A HREF="http://gpsd.berlios.de">gpsd</a> personal GPS server project
<BR><BR>

<H2>AUTHOR</H2>
Hamish Bowman<BR> <i>
Department of Marine Science<BR>
University of Otago<BR>
New Zealand</i><BR>
<BR>

<p><i>Last changed: $Date$</i>
