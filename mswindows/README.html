<html>

<head>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta http-equiv="Content-Language" content="en" />
<meta name="Author" content="Marco Pasetti" />
<meta name="Description" content="SVN mswindows README" />

<title>SVN mswindows README</title>

<style type="text/css" />

/* Wiki Pages Styles */

/* TableOfContents */

.table-of-contents	{ 
					border: 1px solid #bbbbbb;
					color: black; background-color: #eeeeee;
					font-size: small;
					text-align:left;
					margin: 0.5em; padding-left: 1em;
					width: 360;
					}

/* Contents */

html	{
		background-color: white;
		color: black;
		font-family: Arial, Lucida Grande, sans-serif;
		font-size: 10pt;
		}
		
body	{
		margin: 30;
		}
		
ol	{
	font-family: Arial, Lucida Grande, sans-serif;
	font-size: 10pt;
	margin-top: 0;
	margin-bottom: 0;
	margin-left: 0;
	}

h1	{
	font-family: Arial, Lucida Grande, sans-serif;
	font-size: 18pt;
	margin-top: 0;
	margin-bottom: 50;
	}

h2	{
	font-family: Arial, Lucida Grande, sans-serif;
	font-size: 16pt;
	margin-top: 60;
	margin-bottom: 20;
	}
	
h3	{
	font-family: Arial, Lucida Grande, sans-serif;
	font-size: 14pt;
	margin-top: 60;
	margin-bottom: 20;
	}

h4	{
	font-family: Arial, Lucida Grande, sans-serif;
	font-size: 11pt;
	margin-top: 0;
	margin-bottom: 0;
	}

p	{
	font-family: Arial, Lucida Grande, sans-serif;
	font-size: 10pt;
	margin-top: 10;
	margin-bottom: 10;
	}

code	{
		font-family: Courier-new, monospace;
		font-size: 10pt;
		margin-top: 10;
		margin-bottom: 10;
		}
		
pre	{
	padding: 1em;
	border: 1px dashed #2f6fab;
	color: black;
	background-color: #f9f9f9;
	line-height: 1.1em;
	}
	
	
/* Tables */

table
{
	margin: 0.5em 0 0 0.5em;
	border-collapse: collapse;
}

td
{
	padding: 0.25em 0.5em 0.25em 0.5em;
	border: 0pt solid #ADB9CC;
	font-family: Arial, Lucida Grande, sans-serif;
	font-size: 10pt;
}
		

/* Links */

a	{
	text-decoration: none;
	color: #002bb8;
	background: none;
	}
	
a:hover {
		text-decoration: underline;
		color: green;
		}
	
a:visited:hover	{
				text-decoration: underline;
				color: red;
				}
</style>

</head>

<body>

<h1>How to prepare a WinGRASS Release</h1>

<div class="table-of-contents">

<p><strong>Table of Contents</strong></p>

<p><a href="#Introduction">Introduction</a></p>

<p><ol>
<li><a href="#Install MSYS">Install MSYS</a></li>
<li><a href="#Install MinGW">Install MinGW</a></li>
<li><a href="#Install the GRASS MSYS Environment">Install the GRASS MSYS Environment</a></li>
<li><a href="#Build and Install GRASS">Build and Install GRASS</a></li>
<li><a href="#Create a GRASS self-contained Package">Create a GRASS self-contained Package</a></li>
<li><a href="#Install NSIS">Install NSIS</a></li>
<li><a href="#Create the WinGRASS Installer">Create the WinGRASS Installer</a></li>
</ol></p>

<p><a href="#Credits and Contacts">Credits and Contacts</a></p>

<br>

</div>



<div id="Introduction">

<p><h3>Introduction</h3></p>


<p>This document explains how to prepare a WinGRASS release (as a self-contained package installer) using the scripts contained
in the SVN Win32 folder. In order to avoid mistakes or misunderstandings, I highly recommend to follow each step and command
exactly as they are written in this document.</p>

</div>




<div id="Install MSYS">

<p><h3>1. Install MSYS (1.0.11)</h3></p>

<p>Download the <a target="_blank" href="http://prdownloads.sourceforge.net/mingw/MSYS-1.0.11-2004.04.30-1.exe">MSYS installer</a></p>

<p>Install to <code>c:\msys</code></p>

<p>At the command prompt question for post install, type <code>n</code> and then enter.</p>

<p>Download the <a target="_blank" href="http://downloads.sourceforge.net/mingw/coreutils-5.97-MSYS-1.0.11-snapshot.tar.bz2">MSYS coreutils package</a></p>

<p>Unpack it to a temporary folder, then copy all the content of the <code>coreutils-5.97</code> folder to <code>c:\msys</code>
(overwrite the existing files when asked)</p>

</div>




<div id="Install MinGW">

<p><h3>2. Install MinGW (5.1.4)</h3></p>

<p>Download the <a target="_blank" href="http://downloads.sourceforge.net/mingw/MinGW-5.1.4.exe">MinGW installer</a></p>

<p>Select "Download and Install Current Version";</p>

<p>Install only "g++ compiler" and "MinGW Make";</p>

<p>Install to <code>c:\msys\mingw</code></p>

</div>




<div id="Install the GRASS MSYS Environment">

<p><h3>3. Install the GRASS MSYS Environment</h3></p>

<p>Download the <a target="_blank" href="http://grass.osgeo.org/grass63/binary/mswindows/native/GRASS_MSYS_Environment.zip">
GRASS MSYS Environment</a></p>

<p>Extract the whole package to <code>c:\msys\local</code></p>

</div>




<div id="Build and Install GRASS">

<p><h3>4. Build and Install GRASS (6.3.0)</h3></p>

<p>Download the <a target="_blank" href="http://grass.osgeo.org/grass63/source/grass-6.3.0.tar.gz">GRASS source code</a></p>

<p>Unpack to <code>c:\msys\local\src</code></p>

<p>Open <code>c:\msys\local\src\grass-6.3.0\man\Makefile</code></p>

<p>At line 13, replace:</p>
<pre><code>default: $(MANPAGES)</pre></code>

<p>with:</p>
<pre><code>default:</pre></code>

<p>In MSYS console, type:</p>
<pre><code>cd /usr/local/src/grass-6.3.0
./configure \
--prefix=/usr/local \
--with-includes=/usr/local/include \
--with-libs=/usr/local/lib \
--disable-x11 \
--without-x \
--with-cxx \
--enable-shared \
--enable-largefile \
--with-opengl=windows \
--with-fftw \
--with-freetype \
--with-proj-share=/usr/local/share/proj \
--with-gdal=/usr/local/bin/gdal-config \
--with-tcltk --with-tcltk-includes=/usr/local/tcl-tk/include --with-tcltk-libs=/usr/local/tcl-tk/bin \
--with-sqlite --with-sqlite-includes=/usr/local/sqlite/include --with-sqlite-libs=/usr/local/sqlite/lib \
--with-postgres --with-postgres-includes=/usr/local/pgsql/include --with-postgres-libs=/usr/local/pgsql/lib</code></pre>

<p>When finished, you should have the following screen output:</p>
<pre><code>GRASS is now configured for:  i686-pc-mingw32

 Source directory:            /usr/local/src/grass-6.3.0
 Build directory:             /usr/local/src/grass-6.3.0
 Installation directory:      ${prefix}/grass-6.3.0
 Startup script in directory: ${exec_prefix}/bin
 C compiler:                  gcc -g -O2 
 C++ compiler:                c++ -g -O2
 Building shared libraries:   yes
 64bit support:               no
 OpenGL platform:             Windows

  NVIZ:                       yes

  BLAS support:               no
  C++ support:                yes
  DWG support:                no
  FFMPEG support:             no
  FFTW support:               yes
  FreeType support:           yes
  GDAL support:               yes
  GLw support:                no
  JPEG support:               yes
  LAPACK support:             no
  Large File Support (LFS):   yes
  Motif support:              no
  MySQL support:              no
  NLS support:                no
  ODBC support:               no
  OGR support:                yes
  OpenGL support:             yes
  PNG support:                yes
  PostgreSQL support:         yes
  Python support:             no
  Readline support:           no
  SQLite support:             yes
  Tcl/Tk support:             yes
  wxWidgets support:          no
  TIFF support:               yes
  X11 support:                no
  MacOSX application:         no</code></pre>

Having GRASS successfully configured, now you can build it:
<pre><code>export PATH="/usr/local/bin:/usr/local/tcl-tk/bin:/usr/local/sqlite/bin:/usr/local/pgsql/lib:$PATH"
make</code></pre>

<p>When finished, you should have the following compilation log:</p>

<pre><code>GRASS GIS compilation log
-------------------------
Started compilation: Mon Jun 16 09:08:19 GMT 2008
--
Errors in:
/usr/local/src/grass-6.3.0/raster/r.li/r.li.daemon
/usr/local/src/grass-6.3.0/raster/r.li/r.li.edgedensity
/usr/local/src/grass-6.3.0/raster/r.li/r.li.patchdensity
/usr/local/src/grass-6.3.0/raster/r.li/r.li.patchnum
/usr/local/src/grass-6.3.0/raster/r.li/r.li.shape
/usr/local/src/grass-6.3.0/raster/r.li/r.li.simpson
/usr/local/src/grass-6.3.0/raster/r.li/r.li.shannon
/usr/local/src/grass-6.3.0/raster/r.li/r.li.mps
/usr/local/src/grass-6.3.0/raster/r.li/r.li.mpa
/usr/local/src/grass-6.3.0/raster/r.li/r.li.padcv
/usr/local/src/grass-6.3.0/raster/r.li/r.li.padsd
/usr/local/src/grass-6.3.0/raster/r.li/r.li.padrange
/usr/local/src/grass-6.3.0/raster/r.li/r.li.cwed
/usr/local/src/grass-6.3.0/raster/r.li/r.li.richness
/usr/local/src/grass-6.3.0/raster/r.li/r.li.dominance
--
In case of errors please change into the directory with error and run 'make'.
If you get multiple errors, you need to deal with them in the order they
appear in the error log. If you get an error building a library, you will
also get errors from anything which uses the library.
--
Finished compilation: Mon Jun 16 10:11:17 GMT 2008
make: *** [default] Error 1</code></pre>

<p>Then install GRASS:</p>

<pre><code>make install</code></pre>

<p>Now GRASS should be installed in <code>c:\msys\local\grass-6.3.0</code></p>

</div>




<div id="Create a GRASS self-contained Package">

<p><h3>5. Create a GRASS self-contained Package</h3></p>

<p>Copy all the content of the SVN Win32 folder to a temporary directory, for example <code>c:\temp</code>.</p>

<p>Launch the file <code>c:\temp\GRASS-Packager.bat</code> and select the option number 1.</p>

<p>When finished, you should have a GRASS self-contained release package in <code>c:\temp\GRASS-Release-Package</code>.</p>

</div>




<div id="Install NSIS">

<p><h3>6. Install NSIS (2.38)</h3></p>

<p>Download the <a target="_blank" href="http://prdownloads.sourceforge.net/nsis/nsis-2.38-setup.exe">NSIS installer</a></p>

<p>Install to <code>c:\DevTools</code></p>

</div>




<div id="Create the WinGRASS Installer">

<p><h3>7. Create the WinGRASS Installer</h3></p>

<p>Open the the file <code>c:\temp\GRASS-Installer.nsi</code>.</p>

<p>At line 17 set the <code>INSTALLER_TYPE</code> variable to <code>"Release"</code>, then, at lines 23-25, set the
<code>RELEASE_VERSION_NUMBER</code>, the <code>RELEASE_SVN_REVISION</code> and the <code>RELEASE_BINARY_REVISION</code> variables.</p>

<p>Finally, right click on the file <code>c:\temp\GRASS-Installer.nsi</code> and select <code>Compile NSIS Script</code>.</p>

<p>When finished, you should have the WinGRASS release installer in <code>c:\temp</code>.</p>

</div>




<div id="Credits and Contacts">

<p><h3>Credits and Contacts</h3></p>

<p>The GRASS MSYS Environment and the GRASS Packager and Installer scripts are provided by Marco Pasetti.</p>

<p>To contact him, e-mail to: GRASS Development Mailing List
(<a target="_blank" href="http://lists.osgeo.org/mailman/listinfo/grass-dev">http://lists.osgeo.org/mailman/listinfo/grass-dev</a>).</p>

<p>Edited by Marco Pasetti on 14 July 2008.</p>

</div>

</body>

</html>