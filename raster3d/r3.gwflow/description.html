<H2>DESCRIPTION</H2>
This numerical program calculates transient, confined groundwater flow in three dimensions
based on volume maps and the current 3d region resolution.
All starting- and boundary-conditions must be provided as 
volume maps.
<br>
<br>
This module calculates the piezometric head and optionally the 
filter velocity field, based on the hydraulic conductivity and the piezometric head. 
The vector components can be visualized with paraview if they are exported
with r3.out.vtk.
<br>
<br>
The groundwater flow will always be calculated transient. 
If you want to calculate stady state, set the timestep 
to a large number (billions of seconds) or set the 
specific yield raster maps to zero.


<H2>NOTES</H2>

The groundwater flow calculation is based on Darcy's law and a 
finite volume discretization. The groundwater flow partial 
differential equation is of the following form:

<p>
(dh/dt)*S = Kxx * (d^2h/dx^2) + Kyy * (d^2h/dy^2) + Kzz * (d^2h/dz^2) + q

<ul>
<li>h -- the piezometric head im meters [m]</li>
<li>dt -- the time step for transient calculation in seconds [s]</li>
<li>S -- the specific yield  [1/m]</li>
<li>b -- the bottom surface of the aquifer meters [m]</li>
<li>Kxx -- the hydraulic conductivity tensor part in x direction in meter per second [m/s]</li>
<li>Kyy -- the hydraulic conductivity tensor part in y direction in meter per seconds [m/s]</li>
<li>Kzz -- the hydraulic conductivity tensor part in z direction in meter per seconds [m/s]</li>
<li>q - inner source in [1/s]</li>
<li>x - distance between cells in x direction [m]</li>
<li>y - distance between cells in y direction [m]</li>
</ul>

<br>
<br>
Two different boundary conditions are implemented, 
the Dirichlet and Neumann conditions. By default the calculation area is surrounded by homogeneous Neumann boundary conditions.
The calculation and boundary status of single cells can be set with the status map, 
the following cell states are supportet:

<ul>
<li>0 == inactive - the cell with status 0 will not be calulated, active cells will have a no flow boundary to an inactive cell</li>
<li>1 == active - this cell is used for groundwater calculation, inner sources can be defined for those cells</li>
<li>2 == Dirichlet - cells of this type will have a fixed piezometric head value which do not change over time </li>
</ul>

<br>
<br>
The groundwater flow equation can be solved with different solvers.
Two iterative solvers with sparse and quadratic matrices support are implemented.
The conjugate gradients (cg) method and the biconjugate gradients-stabilized (bicgstab) method. 
Aditionally two GUASS and LU solvers are available. Those direct solvers
only work with quadratic matrices, so be careful using them with large maps 
(maps of size 10.000 cells will need more than one gigabyte of ram).

<H2>EXAMPLE</H2>
Use this small script to create a working
groundwater flow area and data. Make sure you are not in a lat/lon projection.

<div class="code"><pre>
# set the region accordingly
g.region res=25 res3=25 t=100 b=0 n=1000 s=0 w=0 e=1000

#now create the input raster maps for a confined aquifer
r3.mapcalc "phead=if(row() == 1 && depth() == 4, 50, 40)"
r3.mapcalc "status=if(row() == 1 && depth() == 4, 2, 1)"
r3.mapcalc "well=if(row() == 20 && col() == 20 , -0.00025, 0)"
r3.mapcalc "perm=0.00025"
r3.mapcalc "syield=0.0001"

r3.gwflow --o -s solver=0 phead=phead status=status hc_x=perm hc_y=perm  \
hc_z=perm q=well s=syield r=reacharge output=gwresult dt=8640000 velocity=gwresult_velocity

# The data can be visulaized with paraview when exported with r3.out.vtk
r3.out.vtk -p in=gwresult,status vector=gwresult_velocity_x,gwresult_velocity_y,gwresult_velocity_z out=/tmp/gwdata3d.vtk

#now load the data into paraview

</pre></div>

<H2>SEE ALSO</H2>

<EM><A HREF="r.gwflow.html">r.gwflow</A></EM><br>
<EM><A HREF="r3.out.vtk.html">r3.out.vtk</A></EM><br>

<H2>AUTHOR</H2>
Soeren Gebbert

<p><i>Last changed: $Date$</i>
